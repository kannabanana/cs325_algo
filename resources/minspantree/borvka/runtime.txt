outside loop: O(logv)
Inner loop: O(ElogV)
